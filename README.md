# 通知转发应用

## 应用简介
本应用可实现多设备间的通知相互转发功能。通过获取设备通知访问权限、应用列表权限及网络权限，设备间可双向转发通知原文。转发消息包含原通知的应用跳转接口，若接收设备安装了对应应用，点击转发消息即可跳转至与发送方一致的应用页面。


## 权限引导
首次启动应用时，将显示引导界面，清晰说明所需权限及用途，并引导用户跳转至系统设置页面授予必要权限：
- 通知访问权限（用于获取设备通知内容）
- 应用列表权限（用于识别设备安装的应用，支持转发规则生效）
- 通知发送权限（Android 13及以上及部分ROM需动态请求，用于推送系统通知）

> 建议在引导页统一请求上述所有权限，并对需跳转系统设置的权限自动引导跳转，返回后检测授权状态。

## 功能页面说明
应用包含两个核心页面，建议采用导航栏（BottomNavigationView）进行切换，提升用户体验：
**响应式设计**

- 导航栏始终在短边即竖屏下在下方,横屏下在左侧

- **设备与转发设置**（首页Tab）：
  - 集成转发模式设置与设备管理功能。
  - 顶部区域展示三种转发规则选择（镜像、对等、自定义），以卡片或分组列表形式呈现。
  - 自定义模式下，黑/白名单应用选择建议采用多选对话框和可搜索列表。
  - 下方区域为设备管理：
    - 设备发现与连接、黑名单管理等功能集中于此。
    - 设备列表分为“已连接设备”和“可用设备”两组。
    - 连接请求弹窗采用Material风格，操作明确。
    - 黑名单管理入口建议放在页面右上角菜单。



- **通知历史**：
通知历史（NotificationHistoryScreen）：分组/时间线展示，支持详情、批量操作。

通过 NotificationRepository 获取本机及已连接设备的通知历史，按包名分组,key是否相同判断是否为同一条的更新，仅保留同key最新一条。
页面顶部支持设备切换，切换后刷新对应设备通知。(目前仅实现本机)
分组展示：同包名分组，组内按时间降序，多于2条折叠，支持展开/收起。
权限状态自动检测，进入页面时输出日志。
应用图标优先显示本机已安装应用，未安装显示默认图标。
UI全部采用 Miuix Compose 主题组件，分组与列表均用 Miuix 风格。
支持分组折叠、设备切换，后续可扩展批量操作。
通知数据模型详见 NotificationModel.kt，历史数据通过本地缓存持久化，异常有日志输出。

- **接收端通知提示与应用图标显示**：
  - 当接收端收到转发通知时，弹出系统通知或应用内提示。
  - 通过包名匹配本机已安装应用，若存在则在通知或历史列表中显示对应应用的图标。
  - 未安装时可显示默认图标或提示“未安装”。

## 使用流程
1. 首次启动应用，完成权限授予
2. 在“设备与转发设置”页面，发现并连接目标设备（需对方确认“允许”），并选择合适的转发规则
3. 通知将按规则自动转发，历史记录可在“通知历史”页面查看


## 注意事项
- 确保设备处于同一局域网内，以保证设备发现和通知转发功能正常
- 转发功能依赖应用权限，若权限被关闭，需重新授予后才能恢复使用
- 跳转功能仅支持接收设备已安装对应应用的场景



